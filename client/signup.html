<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Simple Signup Experimentation</title>
	<link rel="stylesheet" href="../css/font-awesome.min.css">
</head>
<!-- Very simple HTML at the moment -->
<body>
	<div id="loginAlert" class="modal hide">
		<div class="modal-header">
			<h3>Logging In!</h3>
		</div>
		<div class="modal-body">
			<p>Waiting for reply from the server...</p>
		</div>
	</div>
	{{> main}}
</body>

<template name="main">
	<div id="wrap">
		<div class="container">
			<div id="spacer"></div>
			<div class="row">
				<div id="mainDiv" class="span4 offset4">
				{{#isolate}}
					{{> header}}
				{{/isolate}}
				</div>
			</div>
		</div>
	</div>
		
	<div id="footer">
		<div class="container">
			<p class="muted credit">I am on github <a href="https://github.com/schofld">https://github.com/schofld</a> and this experiment is on <a href="https://github.com/schofld/signup">https://github.com/schofld/signup</a> Follow me and contribute... It's just about learning :)</p>
		</div>
	</div>
</template>

<template name="header">
	{{#if currentUser}}
	<h1 id="username" class="text-center">{{currentUser.username}}'s Profile</h1>
	{{else}}
		{{#if signup}}
			<h1 class="text-center">Sign Up</h1>
		{{else}}
			<h1 class="text-center">Sign In</h1>
		{{/if}}
	{{/if}}
	<hr>
	{{#if currentUser}}
		{{> user_loggedin}}
	{{else}}
		{{> user_loggedout}}
	{{/if}}
</template>

<!-- the Handlebars 'partial' that gets looped to show the user data -->
<template name="profileData">
	{{#if editMode}}
		<fieldset>
			<label><i class="icon-star"></i> Favourite Color</label>
			<input class="span4" id="favcolor" type="text" value="{{profile.favcolor}}">
			<label><i class="icon-map-marker"></i> Location</label>
			<input class="span4" id="location" type="text" value="{{profile.location}}">
			<label><i class="icon-info-sign"></i> Your Bio</label>
			<textarea class="span4" id="bio">{{profile.bio}}</textarea>
			<!--<input class="span4" id="bio" type="text" value="{{profile.bio}}">-->
			<button id="saveEdit" class="btn btn-success" type="submit">Save</button>
		</fieldset>
		</div>
	{{else}}
		<p><i class="icon-star"></i> My fav color is {{profile.favcolor}}</dd>
		<p><i class="icon-map-marker"></i> {{profile.location}}</p>
		<p id="bio"><i class="icon-info-sign"></i> {{profile.bio}}</p>
		<button id="editProfile" class="btn btn-custom" type="submit"><i class="icon-pencil icon-white"></i> Edit Your Profile</button>
	{{/if}}
</template>

<template name="user_loggedin">
	{{#if loggingIn}}
		<p><strong>Logging In!</strong></p>
		<p>Waiting for the response from the server</p>
	{{else}}
		<!-- the user data used to be shown this way
		<p>My fav color is <strong>{{currentUser.profile.favcolor}}</strong></p>
		<p>I am in <strong>{{currentUser.profile.location}}</strong></p>
		-->
		{{#each curuser}}
			{{> profileData}}
		{{/each}}		
		<hr>
		<button id="logout" class="btn" type="submit">Log Out</button>
	{{/if}}
</template>

<template name="user_loggedout">
		{{#if signup}}
			<div class="control-group">
				<div class="controls">	
					<input class="span4" id="usernameup" type="text" pattern="\w{3,9}" data-validation-pattern-message="Must be alphanumerical at least 3 characters and no longer then 9" placeholder="Choose a username">
					<p class="help-block">At least 3 characters and less then 9</p>
				</div>
			</div>
			<div class="control-group">
				<div class="controls">
					<input class="span4" id="emailup" type="email" placeholder="Your email" required>
					<p class="help-block">You will sent an email to confirm your address</p>
				</div>
			</div>
			<div class="control-group">
				<div class="controls">
					<input class="span4" id="passwordup" type="password" pattern="\w{4,9}" data-validation-pattern-message="Must be alphanumerical at least 4 characters and no longer then 9" placeholder="Create a password">
					<p class="help-block">Choose your password</p>
				</div>
			</div>
			<hr>
			<p><strong>Share someting about yourself</strong></p>
			<input class="span4" id="favcolor" type="text" placeholder="What is you Fav color?">
			<input class="span4" id="location" type="text" placeholder="Where are you?">
			</br>
			<button id="createUser" class="btn btn-success" type="submit">Create Your Account</button>
		{{else}}
			<p>Login with your account </p>
			<input class="span4" id="username" type="text" placeholder="username">
			<input class="span4" id="password" type="password" placeholder="password">
			</br>
			<button id="login" class="btn btn-success" type="submit">Sign In</button>
			<hr>
			<p>New user? <a id="signup">Sign up now!</a></p>
		{{/if}}
</template>
